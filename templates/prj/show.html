{% extends "layout.html" %}
{% block css %}
<link rel="stylesheet" href="/static/prj/css/page.css" type="text/css" />
<link rel="stylesheet"
  href="/static/common/node_modules/bulma-extensions/bulma-timeline/dist/css/bulma-timeline.min.css">
{% endblock %}

{% block content %}
<section class="hero is-medium is-primary is-bold">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-narrow">
          <h1 class="title is-1">
            {{ data['name'] }}
          </h1>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="main-contents" class="section">
  <div id="project-form" class="container">
    <div class="columns">
      <div class="column is-8">
        <article class="message is-primary">
          <div class="message-header">
            <p>プロジェクトのゴール／ミッション</p>
          </div>
          <div class="message-body">
            {{ data['goal'] }}
          </div>
        </article>

        <article class="message is-link">
          <div class="message-header">
            <p>課題・背景　　なぜやるのか？ 抱えている課題とは？</p>
          </div>
          <div class="message-body">
            {{ data['issue'] }}
          </div>
        </article>

        <article class="message is-warning">
          <div class="message-header">
            <p>プロジェクト概要　　なにをやるのか？</p>
          </div>
          <div class="message-body">
            {{ data['description'] }}
          </div>
        </article>
      </div>
      <div class="column is-4">
        <article class="message is-info">
          <div class="message-header">
            <p>プロジェクトメンバー</p>
          </div>
          <div class="message-body">
            {% for i in data['members'] %}
              {% if 'leader' == data['members'][loop.index0]['member_type'] %}
                <p class="subtitle is-6">プロジェクトオーナー</p>
              {% endif %}
              <p class="title is-4">{{data['members'][loop.index0]['user_name']}}</p>
            {% endfor %}
          </div>
        </article>
        {% if not data['is_joined'] %}
        {% set is_hidden = 'is-hidden' if not data['is_login'] else "" %}
        <button id="prj-join-btn" class="button is-info is-full {{is_hidden}}" style="width:100%;">
          <span class="has-text-weight-bold"><i class="fa fa-user-plus"></i> このプロジェクトに参加する</span>
        </button>
        {% endif %}
      </div>
    </div>
    <div class="columns is-centered">
      <div class="column is-narrow is-6">
        <h3 class="title is-3">プロジェクトの出来事</h3>
        <div class="timeline">
          <header class="timeline-header">
            <span class="tag is-medium is-primary">{{ data['start_date'] }}</span>
          </header>
          <div class="timeline-item is-primary">
            <div class="timeline-marker is-primary"></div>
            <div class="timeline-content">
              <p class="heading">プロジェクト作成</p>
            </div>
          </div>
          {% for i in data['timeline'] %}
          {% set outer_loop = loop %}
          <header class="timeline-header">
            <span class="tag is-primary">{{ data['timeline'][loop.index0]['date_label'] }}</span>
          </header>
          {% for j in data['timeline'][loop.index0]['events'] %}
          <div class="timeline-item is-danger">
            <div class="timeline-marker is-danger is-icon">
              <i class="fa fa-flag"></i>
            </div>
            <div class="timeline-content">
              <p class="heading">{{ data['timeline'][outer_loop.index0]['events'][loop.index0]['type'] }}</p>
              <p>{{ data['timeline'][outer_loop.index0]['events'][loop.index0]['detail'] }}</p>
            </div>
          </div>
          {% endfor %}
          {% endfor %}
          <header class="timeline-header">
            <span class="tag is-medium is-primary">Now In Progress</span>
          </header>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block js %}
<script async src="/static/prj/js/page.js"></script>

{% endblock %}